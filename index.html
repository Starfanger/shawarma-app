<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Doner Duck</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --orange: #ff5e00; --light-bg: #fff8f0; }
        body { font-family: sans-serif; margin: 0; padding: 15px; background: #fff; color: #333; }
        .header { text-align: center; color: var(--orange); margin-bottom: 20px; }
        .section-title { font-size: 18px; font-weight: bold; margin: 15px 0 10px; }
        
        .card { border: 2px solid #eee; border-radius: 12px; padding: 15px; margin-bottom: 10px; cursor: pointer; transition: 0.2s; }
        .card.active { border-color: var(--orange); background: var(--light-bg); }
        
        .row { display: flex; gap: 10px; }
        .row > .card { flex: 1; text-align: center; }
        
        .ingredient { display: flex; align-items: center; justify-content: space-between; padding: 10px; border-bottom: 1px solid #eee; }
        .ingredient input { width: 20px; height: 20px; accent-color: var(--orange); }

        .footer { position: fixed; bottom: 0; left: 0; right: 0; padding: 15px; background: #fff; border-top: 1px solid #eee; }
        .order-btn { width: 100%; background: var(--orange); color: white; border: none; padding: 16px; border-radius: 12px; font-size: 16px; font-weight: bold; cursor: pointer; }
        .order-btn:disabled { background: #ccc; }
        
        input[type="number"] { width: 50px; padding: 5px; border-radius: 5px; border: 1px solid #ccc; }
        padding-bottom { height: 100px; }
    </style>
</head>
<body>

    <div class="header"><h1>ü¶Ü DONER DUCK</h1></div>

    <div class="section-title">–¢–∏–ø —à–∞—É—Ä–º—ã</div>
    <div class="row" id="typeContainer">
        <div class="card active" data-type="chicken">–ö—É—Ä–∏–Ω–∞—è<br><small>5.00 Br</small></div>
        <div class="card" data-type="beef">–ú—è—Å–Ω–∞—è<br><small>6.00 Br</small></div>
    </div>

    <div class="section-title">–†–∞–∑–º–µ—Ä</div>
    <div class="row" id="sizeContainer">
        <div class="card active" data-size="standard" data-add="0">–°—Ç–∞–Ω–¥–∞—Ä—Ç</div>
        <div class="card" data-size="large" data-add="2.5">–ë–æ–ª—å—à–∞—è (+2.50)</div>
    </div>

    <div class="section-title">–î–æ–±–∞–≤–∫–∏</div>
    <div id="ingredientsContainer">
        <label class="ingredient"><span>–î–æ–ø. –º—è—Å–æ (+1.50)</span> <input type="checkbox" value="meat" data-price="1.50"></label>
        <label class="ingredient"><span>–°—ã—Ä (+0.80)</span> <input type="checkbox" value="cheese" data-price="0.80"></label>
        <label class="ingredient"><span>–û—Å—Ç—Ä—ã–π —Å–æ—É—Å (+0.30)</span> <input type="checkbox" value="spicy" data-price="0.30"></label>
    </div>

    <div class="section-title">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: <input type="number" id="qty" value="1" min="1"></div>

    <div style="height: 100px;"></div>

    <div class="footer">
        <button id="mainBtn" class="order-btn">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑ (<span id="totalPrice">5.00</span> Br)</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let state = {
            type: 'chicken',
            size: 'standard',
            quantity: 1,
            basePrice: 5.00
        };

        function calculate() {
            let total = state.basePrice;
            // –î–æ–ø–ª–∞—Ç–∞ –∑–∞ —Ä–∞–∑–º–µ—Ä
            if (state.size === 'large') total += 2.50;
            if (state.type === 'beef') total += 1.00;
            
            // –î–æ–±–∞–≤–∫–∏
            document.querySelectorAll('#ingredientsContainer input:checked').forEach(el => {
                total += parseFloat(el.dataset.price);
            });

            total *= state.quantity;
            document.getElementById('totalPrice').innerText = total.toFixed(2);
            return total;
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫
        document.querySelectorAll('.card').forEach(card => {
            card.onclick = () => {
                const parent = card.parentElement;
                parent.querySelectorAll('.card').forEach(c => c.classList.remove('active'));
                card.classList.add('active');
                
                if (card.dataset.type) state.type = card.dataset.type;
                if (card.dataset.size) state.size = card.dataset.size;
                calculate();
            };
        });

        document.getElementById('qty').oninput = (e) => {
            state.quantity = parseInt(e.target.value) || 1;
            calculate();
        };

        document.querySelectorAll('input[type="checkbox"]').forEach(ch => {
            ch.onchange = calculate;
        });

        // –û–¢–ü–†–ê–í–ö–ê –î–ê–ù–ù–´–•
        document.getElementById('mainBtn').onclick = () => {
            const finalPrice = calculate();
            const ingredients = [];
            document.querySelectorAll('#ingredientsContainer input:checked').forEach(el => {
                ingredients.push({ name: el.parentElement.innerText.split('(')[0].trim() });
            });

            const data = {
                type: state.type,
                size: state.size,
                quantity: state.quantity,
                ingredients: ingredients,
                total: finalPrice,
                currency: 'BYN'
            };

            tg.sendData(JSON.stringify(data)); // –≠—Ç–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É
        };
    </script>
</body>
</html>
