<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–®–∞—É—Ä–º–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg: #050505;
            --card: #121212;
            --primary: #ffffff;
            --secondary: #222222;
            --accent: #ffdd00;
            --text: #ffffff;
            --text-muted: #888888;
        }

        body.light {
            --bg: #f8f8f8;
            --card: #ffffff;
            --primary: #000000;
            --secondary: #f0f0f0;
            --text: #000000;
            --text-muted: #666666;
        }

        body {
            /* –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∏—â–µ–º Noto Color Emoji, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–º–µ–Ω–∏–ª —Ç–≤–æ–π —Å–∫—Ä–∏–ø—Ç */
            font-family: 'Inter', -apple-system, "Noto Color Emoji", "Apple Color Emoji", sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0; padding: 0;
            transition: background 0.3s;
            -webkit-tap-highlight-color: transparent;
        }

        header {
            padding: 24px 20px;
            display: flex; justify-content: space-between; align-items: center;
        }

        h1 { font-size: 28px; font-weight: 800; letter-spacing: -1px; margin: 0; text-transform: uppercase; }

        .container { padding: 0 20px 140px; }

        /* –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ (Minimal Pill Style) */
        .tabs { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 20px; scrollbar-width: none; }
        .tab {
            padding: 8px 16px; background: var(--secondary); border-radius: 12px;
            font-size: 13px; font-weight: 600; white-space: nowrap; color: var(--text-muted);
            transition: 0.2s;
        }
        .tab.active { background: var(--primary); color: var(--bg); }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ */
        .item-card {
            background: var(--card); border-radius: 20px; padding: 20px;
            margin-bottom: 12px; border: 1px solid rgba(255,255,255,0.05);
            transition: transform 0.1s ease;
        }
        .item-card:active { transform: scale(0.98); }
        .item-card h3 { margin: 0 0 6px; font-size: 18px; font-weight: 700; }
        .item-card p { font-size: 14px; color: var(--text-muted); margin: 0 0 16px; line-height: 1.4; }
        
        .price-row { display: flex; justify-content: space-between; align-items: center; }
        .price { font-size: 17px; font-weight: 700; }
        .add-btn {
            background: var(--primary); color: var(--bg); border: none;
            padding: 10px 18px; border-radius: 12px; font-weight: 700; font-size: 13px;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ (Apple Sheet Style) */
        #modalOverlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.7);
            display: none; justify-content: center; align-items: flex-end; z-index: 1000;
        }
        .modal {
            background: var(--card); width: 100%; border-radius: 24px 24px 0 0;
            padding: 30px 20px 40px; box-shadow: 0 -10px 40px rgba(0,0,0,0.5);
        }

        .extra-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 14px 0; border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .extra-item:last-child { border: none; }
        
        .checkbox {
            width: 24px; height: 24px; border: 2px solid var(--text-muted);
            border-radius: 6px; position: relative; transition: 0.2s;
        }
        .extra-item.active .checkbox { background: var(--accent); border-color: var(--accent); }

        /* –°—á–µ—Ç—á–∏–∫ */
        .qty-box {
            display: flex; align-items: center; justify-content: center;
            gap: 30px; margin: 30px 0; background: var(--secondary);
            padding: 12px; border-radius: 16px;
        }
        .qty-btn { font-size: 24px; background: none; border: none; color: var(--text); padding: 0 10px; }

        /* –ö–Ω–æ–ø–∫–∞ –∑–∞–∫–∞–∑–∞ */
        .footer-cart {
            position: fixed; bottom: 30px; left: 20px; right: 20px;
            background: var(--primary); color: var(--bg);
            border-radius: 18px; padding: 18px 24px;
            display: none; justify-content: space-between; align-items: center;
            font-weight: 800; box-shadow: 0 15px 30px rgba(0,0,0,0.3);
            z-index: 900;
        }
    </style>
</head>
<body>

<header>
    <h1>–®–ê–£–†–ú–ê</h1>
    <div onclick="document.body.classList.toggle('light')" style="font-size: 20px; opacity: 0.5;">üåì</div>
</header>

<div class="container">
    <div class="tabs">
        <div class="tab active" onclick="filter('all', this)">–í—Å–µ</div>
        <div class="tab" onclick="filter('classic', this)">–ö–ª–∞—Å—Å–∏–∫–∞</div>
        <div class="tab" onclick="filter('special', this)">–û—Å–æ–±–æ–µ</div>
    </div>
    <div id="catalog"></div>
</div>

<div id="modalOverlay">
    <div class="modal">
        <h2 id="mName" style="margin-top:0">–ù–∞–∑–≤–∞–Ω–∏–µ</h2>
        <div id="mExtras"></div>
        <div class="qty-box">
            <button class="qty-btn" onclick="changeQty(-1)">‚àí</button>
            <span id="mQty" style="font-size: 20px; font-weight: 800;">1</span>
            <button class="qty-btn" onclick="changeQty(1)">+</button>
        </div>
        <button onclick="confirmItem()" style="width: 100%; padding: 18px; border-radius: 16px; border: none; background: var(--primary); color: var(--bg); font-weight: 800; font-size: 16px;">
            –î–æ–±–∞–≤–∏—Ç—å –∑–∞ <span id="mTotal">0</span> BYN
        </button>
    </div>
</div>

<div class="footer-cart" id="cartBar" onclick="sendOrder()">
    <span>–ö–û–†–ó–ò–ù–ê (<span id="cCount">0</span>)</span>
    <span><span id="cPrice">0</span> BYN</span>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    const menu = [
        { id: 1, cat: 'classic', name: 'üåØ –ö–ª–∞—Å—Å–∏–∫–∞ –ñ–æ–ø—ã', price: 7.5, desc: '–¢–∞ —Å–∞–º–∞—è, —Å –∫–æ—Ç–æ—Ä–æ–π –≤—Å—ë –Ω–∞—á–∞–ª–æ—Å—å. –°–æ—É—Å –ø–æ —Å–µ–∫—Ä–µ—Ç–Ω–æ–º—É —Ä–µ—Ü–µ–ø—Ç—É.' },
        { id: 2, cat: 'special', name: 'üî• –ñ–≥—É—á–∏–π –î–µ–¥', price: 9.0, desc: '–û—Å—Ç—Ä–∞—è, –∫–∞–∫ —à—É—Ç–∫–∏ –∑–∞ 300. –ü—Ä–æ–±–∏–≤–∞–µ—Ç –Ω–∞—Å–∫–≤–æ–∑—å.' },
        { id: 3, cat: 'classic', name: 'üßÄ –°—ã—Ä–Ω—ã–π –ö—É—à', price: 10.5, desc: '–ß–µ—Ç—ã—Ä–µ —Å—ã—Ä–∞ –∏ –æ–¥–Ω–∞ —à–∞—É—Ä–º–∞. –¢—è–Ω–µ—Ç—Å—è –¥–æ —Å–æ—Å–µ–¥–Ω–µ–≥–æ —Ä–∞–π–æ–Ω–∞.' },
        { id: 4, cat: 'special', name: 'üèÜ –õ–µ–≥–µ–Ω–¥–∞ 54', price: 12.0, desc: '–≠–ª–∏—Ç–Ω—ã–π —Å–≤–µ—Ä—Ç–æ–∫ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –ø–æ–∑–Ω–∞–ª –∂–∏–∑–Ω—å.' }
    ];

    const extras = [
        { name: 'üßÄ –î–æ–ø –°—ã—Ä', price: 1.5 },
        { name: 'üå∂ –•–∞–ª–∞–ø–µ–Ω—å–æ', price: 1.0 },
        { name: 'ü•ì –ë–µ–∫–æ–Ω', price: 2.5 }
    ];

    let cart = [];
    let currentItem = null;
    let selectedExtras = new Set();
    let currentQty = 1;

    function render(cat = 'all') {
        const catalog = document.getElementById('catalog');
        catalog.innerHTML = '';
        menu.forEach(item => {
            if (cat !== 'all' && item.cat !== cat) return;
            const div = document.createElement('div');
            div.className = 'item-card';
            div.innerHTML = `
                <h3>${item.name}</h3>
                <p>${item.desc}</p>
                <div class="price-row">
                    <span class="price">${item.price.toFixed(2)} BYN</span>
                    <button class="add-btn" onclick="openModal(${item.id})">–í–´–ë–†–ê–¢–¨</button>
                </div>
            `;
            catalog.appendChild(div);
        });
    }

    function openModal(id) {
        currentItem = menu.find(m => m.id === id);
        selectedExtras.clear();
        currentQty = 1;
        document.getElementById('mName').innerText = currentItem.name;
        document.getElementById('mQty').innerText = currentQty;
        
        const mExtras = document.getElementById('mExtras');
        mExtras.innerHTML = '';
        extras.forEach(ex => {
            const div = document.createElement('div');
            div.className = 'extra-item';
            div.innerHTML = `<span>${ex.name} (+${ex.price})</span><div class="checkbox"></div>`;
            div.onclick = () => {
                div.classList.toggle('active');
                selectedExtras.has(ex) ? selectedExtras.delete(ex) : selectedExtras.add(ex);
                updateModalPrice();
            };
            mExtras.appendChild(div);
        });
        updateModalPrice();
        document.getElementById('modalOverlay').style.display = 'flex';
    }

    function updateModalPrice() {
        let p = currentItem.price;
        selectedExtras.forEach(e => p += e.price);
        document.getElementById('mTotal').innerText = (p * currentQty).toFixed(2);
    }

    function changeQty(v) {
        currentQty = Math.max(1, currentQty + v);
        document.getElementById('mQty').innerText = currentQty;
        updateModalPrice();
    }

    function confirmItem() {
        let p = currentItem.price;
        selectedExtras.forEach(e => p += e.price);
        cart.push({
            name: currentItem.name,
            qty: currentQty,
            price: p * currentQty,
            extras: Array.from(selectedExtras).map(e => e.name)
        });
        document.getElementById('modalOverlay').style.display = 'none';
        updateCart();
    }

    function updateCart() {
        const bar = document.getElementById('cartBar');
        if (cart.length > 0) {
            bar.style.display = 'flex';
            const total = cart.reduce((s, i) => s + i.price, 0);
            document.getElementById('cCount').innerText = cart.length;
            document.getElementById('cPrice').innerText = total.toFixed(2);
        }
    }

    function filter(c, el) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        el.classList.add('active');
        render(c);
    }

    function sendOrder() {
        tg.sendData(JSON.stringify({
            items: cart,
            total: cart.reduce((s, i) => s + i.price, 0)
        }));
    }

    window.onclick = (e) => { if(e.target == document.getElementById('modalOverlay')) document.getElementById('modalOverlay').style.display = 'none'; }
    render();
</script>
</body>
</html>
