<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–®–ê–£–†–ú–ê PREMIER</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg: #050507;
            --card: rgba(255, 255, 255, 0.03);
            --primary: #ffffff;
            --accent: #00ffa3;
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        body {
            font-family: 'Inter', -apple-system, "Noto Color Emoji", "Apple Color Emoji", sans-serif;
            background: var(--bg); color: #fff; margin: 0; padding: 0;
            overflow-x: hidden; -webkit-font-smoothing: antialiased;
        }

        /* Desktop Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-thumb { background: var(--glass-border); border-radius: 10px; }

        .bg-glow {
            position: fixed; inset: 0;
            background: radial-gradient(circle at 80% 20%, rgba(0, 255, 163, 0.05) 0%, transparent 50%);
            z-index: -1; pointer-events: none;
        }

        header { padding: 30px 20px 10px; }
        h1 { font-size: 24px; font-weight: 900; letter-spacing: -1px; margin: 0; text-transform: uppercase; }

        .container { padding: 0 20px 140px; max-width: 600px; margin: 0 auto; }

        /* –¢–∞–±—ã */
        .tabs { 
            display: flex; gap: 8px; overflow-x: auto; padding: 20px 0; 
            cursor: grab; user-select: none;
        }
        .tabs:active { cursor: grabbing; }
        .tab {
            padding: 8px 16px; background: var(--card); border-radius: 12px;
            font-size: 13px; font-weight: 700; white-space: nowrap;
            border: 1px solid var(--glass-border); transition: 0.3s;
            backdrop-filter: blur(10px);
        }
        .tab.active { background: var(--primary); color: #000; transform: scale(1.05); }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
        #catalog { display: grid; gap: 12px; }
        .item-card {
            background: var(--card); border-radius: 20px; padding: 18px;
            border: 1px solid var(--glass-border); backdrop-filter: blur(10px);
            transition: 0.2s; cursor: pointer; position: relative;
        }
        .item-card:hover { border-color: var(--accent); background: rgba(255,255,255,0.05); }
        .item-card h3 { margin: 0 0 4px; font-size: 17px; font-weight: 800; color: var(--accent); }
        .item-card p { font-size: 12px; color: #888; margin: 0 0 12px; line-height: 1.4; }

        .price-row { display: flex; justify-content: space-between; align-items: center; }
        .price { font-weight: 800; font-size: 16px; }
        .add-btn {
            background: var(--primary); color: #000; border: none; padding: 8px 16px;
            border-radius: 10px; font-weight: 800; font-size: 12px;
        }

        /* –ú–æ–¥–∞–ª–∫–∏ */
        .overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.8);
            backdrop-filter: blur(8px); display: none; z-index: 1000;
            justify-content: center; align-items: flex-end;
        }
        .modal {
            background: #0c0c0e; width: 100%; max-width: 500px; border-radius: 24px 24px 0 0;
            padding: 25px; border-top: 1px solid var(--glass-border);
            animation: slideUp 0.3s ease-out;
        }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        .extra-row {
            display: flex; justify-content: space-between; padding: 14px 18px;
            background: rgba(255,255,255,0.03); border-radius: 14px; margin-bottom: 8px;
            border: 1px solid transparent; cursor: pointer; font-size: 14px;
        }
        .extra-row.selected { border-color: var(--accent); background: rgba(0,255,163,0.1); }

        /* –ö–æ—Ä–∑–∏–Ω–∞ */
        .cart-bar {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            width: calc(100% - 40px); max-width: 500px;
            background: var(--accent); color: #000; border-radius: 18px;
            padding: 18px 24px; display: none; justify-content: space-between;
            align-items: center; font-weight: 900; z-index: 900; cursor: pointer;
        }

        .cart-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 12px; background: rgba(255,255,255,0.03);
            border-radius: 14px; margin-bottom: 8px; cursor: pointer;
        }
        .qty-ctrl { display: flex; align-items: center; gap: 10px; }
        .q-btn { width: 28px; height: 28px; border-radius: 8px; border: 1px solid #333; background: #000; color: #fff; cursor: pointer; }
    </style>
</head>
<body>

<div class="bg-glow"></div>

<header>
    <h1>–®–ê–£–†–ú–ê</h1>
</header>

<div class="container">
    <div class="tabs" id="tabsList">
        <div class="tab active" onclick="filter('valakas', this)">üë¥ –í–ê–õ–ê–ö–ê–°</div>
        <div class="tab" onclick="filter('opop', this)">üï∫ –û–ü-–û–ü</div>
        <div class="tab" onclick="filter('simonov', this)">üëë –°–ò–ú–û–ù–û–í</div>
        <div class="tab" onclick="filter('burgers', this)">üçî –ë–£–†–ì–ï–†–´</div>
    </div>
    <div id="catalog"></div>
</div>

<div id="modalOverlay" class="overlay">
    <div class="modal">
        <h2 id="mName" style="margin: 0 0 5px; font-size: 22px;"></h2>
        <p id="mDesc" style="color: #666; font-size: 13px; margin-bottom: 20px;"></p>
        <div id="mExtras"></div>
        <div style="margin: 20px 0; text-align: center; font-size: 22px; font-weight: 900;" id="mTotal">0 BYN</div>
        <button id="mainModalBtn" onclick="addToCart()" style="width: 100%; padding: 18px; border-radius: 16px; border: none; background: var(--accent); color: #000; font-weight: 900; font-size: 15px; cursor: pointer;">
            –ü–û–î–¢–í–ï–†–î–ò–¢–¨
        </button>
    </div>
</div>

<div id="cartOverlay" class="overlay">
    <div class="modal" style="max-height: 80vh; overflow-y: auto;">
        <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
            <h2 style="margin:0; font-size: 20px;">–ö–æ—Ä–∑–∏–Ω–∞</h2>
            <span onclick="closeCart()" style="cursor:pointer; opacity:0.5">–ó–∞–∫—Ä—ã—Ç—å</span>
        </div>
        <div id="cartList"></div>
        <div style="margin-top: 20px; border-top: 1px solid #222; padding-top: 20px;">
            <div style="display: flex; justify-content: space-between; font-size: 20px; font-weight: 900; margin-bottom: 20px;">
                <span>–ò–¢–û–ì–û:</span> <span id="cartFullPrice">0</span>
            </div>
            <button onclick="sendOrder()" style="width: 100%; padding: 18px; border-radius: 16px; border: none; background: #fff; color: #000; font-weight: 900; font-size: 15px; cursor: pointer;">
                –û–§–û–†–ú–ò–¢–¨ –ó–ê–ö–ê–ó
            </button>
        </div>
    </div>
</div>

<div class="cart-bar" id="cartBar" onclick="openCart()">
    <span id="cCount">0 –ü–û–ó–ò–¶–ò–ô</span>
    <span id="cPrice">0.00 BYN</span>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    const menu = [
        { id: 1, cat: 'valakas', name: 'üë¥ –î–∞-–¥–∞-—è –ö–ª–∞—Å—Å–∏–∫', price: 7.0, desc: '–ë–∞–∑–æ–≤–∞—è –¥–ª—è –ø–æ–∂–∏–ª—ã—Ö. 54 –≥–æ–¥–∞ –≤—ã–¥–µ—Ä–∂–∫–∏.' },
        { id: 2, cat: 'valakas', name: 'üëü –ü–µ–Ω–∏—Å—ã –ö—Ä–æ–ª–∏–∫–∞', price: 9.5, desc: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ —Ç–∞–ø–∫–∏ –≤ –ª–∞–≤–∞—à–µ.' },
        { id: 3, cat: 'valakas', name: 'üíä –¢—É–ø–∞ –û—Ç–¥—ã—Ö', price: 8.0, desc: '–£—Å–ø–æ–∫–∞–∏–≤–∞—é—â–∞—è —à–∞—É—Ä–º–∞.' },
        { id: 21, cat: 'opop', name: 'üï∫ –°–ø—Ä–∏–ø–æ–¥–≤—ã–ø–æ–¥–≤–µ—Ä—Ç–æ–º', price: 10.0, desc: '–ó–∞–∫—Ä—É—á–µ–Ω–∞ –≤ –æ–±—Ä–∞—Ç–Ω—É—é —Å—Ç–æ—Ä–æ–Ω—É.' },
        { id: 41, cat: 'simonov', name: 'üëë –ö–æ—Ä–æ–ª—å –î–∏–∑–ª–∞–π–∫–æ–≤', price: 13.0, desc: '–ú—è—Å–æ –∫–∞–±–∞–Ω–∞ –∏ —Ö–∞–π–ø.' },
        { id: 61, cat: 'burgers', name: 'üçî –ì–ò–ì–ê-–ñ–ú–´–•', price: 14.0, desc: '–†–∞–∑–º–µ—Ä–æ–º —Å –≥–æ–ª–æ–≤—É –∫—Ä–æ–ª–∏–∫–∞.' }
    ];

    const extras = [
        { name: 'üßÄ –ñ–∏—Ä –ñ–º—ã—à–µ–Ω–∫–æ', price: 1.5 },
        { name: 'üå∂ –°–ª—ë–∑—ã –õ–∏–Ω–µ–π–Ω–æ–π', price: 1.0 },
        { name: 'ü•© –õ–∏—à–Ω—è—è –•—Ä–æ–º–æ—Å–æ–º–∞', price: 3.5 }
    ];

    let cart = [];
    let editingCartId = null;
    let tempItem = null;
    let tempExtras = new Set();

    function render(cat = 'valakas') {
        const catalog = document.getElementById('catalog');
        catalog.innerHTML = '';
        menu.filter(i => i.cat === cat).forEach(item => {
            const div = document.createElement('div');
            div.className = 'item-card';
            div.onclick = () => openItem(item.id); // –ö–ª–∏–∫ –ø–æ –≤—Å–µ–π –∫–∞—Ä—Ç–æ—á–∫–µ
            div.innerHTML = `
                <h3>${item.name}</h3>
                <p>${item.desc}</p>
                <div class="price-row">
                    <span class="price">${item.price.toFixed(2)} BYN</span>
                    <button class="add-btn">–í–´–ë–†–ê–¢–¨</button>
                </div>
            `;
            catalog.appendChild(div);
        });
    }

    // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ (–¥–ª—è –Ω–æ–≤–æ–≥–æ –∏–ª–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
    function openItem(id, cartId = null) {
        editingCartId = cartId;
        const source = cartId ? cart.find(x => x.cid === cartId) : null;
        tempItem = menu.find(m => m.id === id);
        tempExtras.clear();

        if (source) {
            source.details.forEach(name => {
                const ex = extras.find(e => e.name === name);
                if (ex) tempExtras.add(ex);
            });
        }

        document.getElementById('mName').innerText = tempItem.name;
        document.getElementById('mDesc').innerText = tempItem.desc;
        
        const mExtras = document.getElementById('mExtras');
        mExtras.innerHTML = '';
        extras.forEach(ex => {
            const div = document.createElement('div');
            div.className = `extra-row ${tempExtras.has(ex) ? 'selected' : ''}`;
            div.innerHTML = `<span>${ex.name}</span> <span>+${ex.price}</span>`;
            div.onclick = (e) => {
                e.stopPropagation();
                div.classList.toggle('selected');
                tempExtras.has(ex) ? tempExtras.delete(ex) : tempExtras.add(ex);
                updateTempPrice();
            };
            mExtras.appendChild(div);
        });
        updateTempPrice();
        document.getElementById('modalOverlay').style.display = 'flex';
        document.getElementById('cartOverlay').style.display = 'none';
    }

    function updateTempPrice() {
        let p = tempItem.price;
        tempExtras.forEach(e => p += e.price);
        document.getElementById('mTotal').innerText = p.toFixed(2) + ' BYN';
    }

    function addToCart() {
        let p = tempItem.price;
        tempExtras.forEach(e => p += e.price);
        
        if (editingCartId) {
            const i = cart.find(x => x.cid === editingCartId);
            i.total = p;
            i.details = Array.from(tempExtras).map(e => e.name);
        } else {
            cart.push({
                cid: Date.now(),
                id: tempItem.id,
                name: tempItem.name,
                total: p,
                qty: 1,
                details: Array.from(tempExtras).map(e => e.name)
            });
        }
        
        document.getElementById('modalOverlay').style.display = 'none';
        updateBar();
        if(editingCartId) openCart();
        if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');
    }

    function updateBar() {
        const bar = document.getElementById('cartBar');
        if (cart.length > 0) {
            bar.style.display = 'flex';
            const sum = cart.reduce((s, i) => s + (i.total * i.qty), 0);
            document.getElementById('cCount').innerText = `${cart.length} –ü–û–ó–ò–¶–ò–ò`;
            document.getElementById('cPrice').innerText = sum.toFixed(2) + ' BYN';
        } else bar.style.display = 'none';
    }

    function openCart() {
        const list = document.getElementById('cartList');
        list.innerHTML = '';
        cart.forEach(item => {
            const div = document.createElement('div');
            div.className = 'cart-item';
            div.onclick = () => openItem(item.id, item.cid); // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –∫–ª–∏–∫—É
            div.innerHTML = `
                <div style="flex:1">
                    <div style="font-weight:900; font-size:14px">${item.name}</div>
                    <div style="font-size:10px; color:#666">${item.details.join(', ') || '–ë–µ–∑ –¥–æ–ø–æ–≤'}</div>
                </div>
                <div class="qty-ctrl" onclick="event.stopPropagation()">
                    <button class="q-btn" onclick="editQty(${item.cid}, -1)">-</button>
                    <span style="font-size:14px; font-weight:bold">${item.qty}</span>
                    <button class="q-btn" onclick="editQty(${item.cid}, 1)">+</button>
                    <button onclick="rm(${item.cid})" style="border:none; background:none; color:#ff4444; margin-left:5px">üóë</button>
                </div>
            `;
            list.appendChild(div);
        });
        const sum = cart.reduce((s, i) => s + (i.total * i.qty), 0);
        document.getElementById('cartFullPrice').innerText = sum.toFixed(2) + ' BYN';
        document.getElementById('cartOverlay').style.display = 'flex';
    }

    function editQty(cid, delta) {
        const i = cart.find(x => x.cid === cid);
        if(i) {
            i.qty = Math.max(1, i.qty + delta);
            openCart();
            updateBar();
        }
    }

    function rm(cid) {
        cart = cart.filter(x => x.cid !== cid);
        if (cart.length === 0) closeCart(); else openCart();
        updateBar();
    }

    function closeCart() { document.getElementById('cartOverlay').style.display = 'none'; }

    function filter(c, el) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        el.classList.add('active');
        render(c);
    }

    function sendOrder() {
        tg.sendData(JSON.stringify({ items: cart, total: cart.reduce((s, i) => s + (i.total * i.qty), 0) }));
    }

    window.onclick = (e) => { if(e.target.classList.contains('overlay')) e.target.style.display = 'none'; }
    render('valakas');
</script>
</body>
</html>
