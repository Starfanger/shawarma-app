<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–®–ê–£–†–ú–ê "–Ø–•–ê–ô –ë–ê–õ–Ø" ü•ô</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg: #08080a;
            --card: rgba(20, 20, 25, 0.6);
            --primary: #ffffff;
            --accent: #00ff88;
            --text-muted: #888890;
            --glass: rgba(255, 255, 255, 0.03);
        }

        body {
            font-family: 'Inter', -apple-system, "Noto Color Emoji", sans-serif;
            background-color: var(--bg);
            color: var(--primary);
            margin: 0; padding: 0;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* –§–æ–Ω–æ–≤–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ */
        body::before {
            content: "";
            position: fixed; top: -10%; right: -10%;
            width: 300px; height: 300px;
            background: radial-gradient(circle, rgba(0, 255, 136, 0.15) 0%, transparent 70%);
            z-index: -1; pointer-events: none;
        }

        header { padding: 30px 20px 10px; }
        h1 { font-size: 32px; font-weight: 900; letter-spacing: -1.5px; margin: 0; text-transform: uppercase; }

        .container { padding: 0 20px 140px; }

        /* –¢–∞–±—ã */
        .tabs { display: flex; gap: 10px; overflow-x: auto; padding: 20px 0; scrollbar-width: none; }
        .tab {
            padding: 10px 18px; background: var(--glass); border-radius: 14px;
            font-size: 13px; font-weight: 600; white-space: nowrap; color: var(--text-muted);
            border: 1px solid rgba(255,255,255,0.05); transition: 0.3s;
        }
        .tab.active { background: var(--primary); color: #000; border-color: var(--primary); }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
        .item-card {
            background: var(--card); border-radius: 24px; padding: 20px;
            margin-bottom: 16px; border: 1px solid rgba(255,255,255,0.05);
            backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .item-card:hover, .item-card:active {
            transform: translateY(-5px);
            border-color: var(--accent);
            background: rgba(0, 255, 136, 0.03);
        }
        .item-card h3 { margin: 0 0 8px; font-size: 19px; }
        .item-card p { font-size: 13px; color: var(--text-muted); line-height: 1.5; margin-bottom: 15px; }
        
        .price-row { display: flex; justify-content: space-between; align-items: center; }
        .price { font-weight: 800; font-size: 18px; color: var(--accent); }
        .add-btn {
            background: var(--primary); color: #000; border: none;
            padding: 12px 20px; border-radius: 14px; font-weight: 800;
        }

        /* –ú–æ–¥–∞–ª–∫–∞ –î–æ–ø–æ–≤ */
        #modalOverlay, #cartOverlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px); display: none; z-index: 1000;
            justify-content: center; align-items: flex-end;
        }
        .modal {
            background: #121214; width: 100%; border-radius: 30px 30px 0 0;
            padding: 30px 20px 40px; animation: slideUp 0.3s ease;
        }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        .extra-item {
            display: flex; justify-content: space-between; padding: 15px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .extra-item.selected { color: var(--accent); }

        /* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ö–æ—Ä–∑–∏–Ω–æ–π */
        .cart-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 0; border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .qty-ctrl { display: flex; align-items: center; gap: 15px; }
        .btn-qty { 
            width: 30px; height: 30px; border-radius: 8px; border: 1px solid #333;
            background: none; color: #fff; font-size: 18px;
        }

        /* –ü–ª–∞—à–∫–∞ –ö–æ—Ä–∑–∏–Ω—ã */
        .cart-bar {
            position: fixed; bottom: 30px; left: 20px; right: 20px;
            background: var(--primary); color: #000;
            border-radius: 20px; padding: 20px; display: none;
            justify-content: space-between; align-items: center;
            font-weight: 900; z-index: 900; box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }
    </style>
</head>
<body>

<header>
    <h1>–®–ê–£–†–ú–ê</h1>
</header>

<div class="container">
    <div class="tabs" id="tabsList">
        <div class="tab active" onclick="filter('all', this)">–í—Å–µ</div>
        <div class="tab" onclick="filter('elderly', this)">üë¥ –ñ–º—ã—à–µ–Ω–∫–æ</div>
        <div class="tab" onclick="filter('opop', this)">üï∫ –û–ø-–û–ø</div>
        <div class="tab" onclick="filter('kings', this)">üëë –ö–æ—Ä–æ–ª–∏</div>
    </div>
    <div id="catalog"></div>
</div>

<div id="modalOverlay">
    <div class="modal">
        <h2 id="mName">–ù–∞–∑–≤–∞–Ω–∏–µ</h2>
        <div id="mExtras"></div>
        <div style="margin: 20px 0; text-align: center; font-size: 24px; font-weight: 900;" id="mTotal">0 BYN</div>
        <button onclick="addToCart()" style="width: 100%; padding: 20px; border-radius: 18px; border: none; background: var(--accent); color: #000; font-weight: 900;">
            –î–û–ë–ê–í–ò–¢–¨ –í –ö–û–†–ó–ò–ù–£
        </button>
    </div>
</div>

<div id="cartOverlay">
    <div class="modal" style="max-height: 80vh; overflow-y: auto;">
        <h2 style="display: flex; justify-content: space-between;">–ö–æ—Ä–∑–∏–Ω–∞ <span onclick="closeCart()" style="opacity:0.5; font-size: 16px;">–ó–∞–∫—Ä—ã—Ç—å</span></h2>
        <div id="cartList"></div>
        <div style="margin-top: 20px; border-top: 2px solid #222; padding-top: 20px;">
            <div style="display: flex; justify-content: space-between; font-size: 20px; font-weight: 900; margin-bottom: 20px;">
                <span>–ò–¢–û–ì–û:</span> <span id="cartFullPrice">0</span>
            </div>
            <button onclick="sendOrder()" style="width: 100%; padding: 20px; border-radius: 18px; border: none; background: var(--primary); color: #000; font-weight: 900;">
                –û–¢–ü–†–ê–í–ò–¢–¨ –ó–ê–ö–ê–ó
            </button>
        </div>
    </div>
</div>

<div class="cart-bar" id="cartBar" onclick="openCart()">
    <span>–ö–û–†–ó–ò–ù–ê: <span id="cCount">0</span></span>
    <span>–°–ú–û–¢–†–ï–¢–¨: <span id="cPrice">0</span> BYN</span>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    const menu = [
        { id: 1, cat: 'elderly', name: 'üë¥ –ü–æ–∂–∏–ª–æ–π –†–æ—Ñ–ª', price: 7.0, desc: '–î–∞-–¥–∞-—è! –ö–ª–∞—Å—Å–∏–∫–∞ –æ—Ç –í–∞–ª–µ—Ä–∏—è –ñ–º—ã—à–µ–Ω–∫–æ. 54 –≥–æ–¥–∞ –≤—ã–¥–µ—Ä–∂–∫–∏.' },
        { id: 2, cat: 'elderly', name: 'üëü –ü–µ–Ω–∏—Å—ã –ö—Ä–æ–ª–∏–∫–∞', price: 9.5, desc: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ —Ç–∞–ø–∫–∏ –≤ –ª–∞–≤–∞—à–µ. –í–∫—É—Å –î–µ–Ω–∏—Å–∞ –°—É—Ö–∞—á–µ–≤–∞.' },
        { id: 3, cat: 'opop', name: 'üï∫ –û–ø-–û–ø –°–ø—Ä–∏–ø–æ–¥–≤—ã–ø–æ–¥–≤–µ—Ä—Ç–æ–º', price: 8.5, desc: '–î–≤–∏–∂–µ–Ω–∏–µ - –∂–∏–∑–Ω—å! –®–∞—É—Ä–º–∞, –∫–æ—Ç–æ—Ä–∞—è —Å–∞–º–∞ –∑–∞–ª–µ—Ç–∞–µ—Ç –≤ —Ä–æ—Ç.' },
        { id: 4, cat: 'opop', name: '‚õ™Ô∏è –ú–æ–Ω–∞—Å—Ç—ã—Ä—Å–∫–∞—è –°–ø–µ—Ü–∏—è', price: 11.0, desc: '–ò–∑ –ø–æ–¥–Ω–∏–∑–æ–≤—Å–∫–∏—Ö –∫—Ä–∞–µ–≤. –û—Å–≤—è—â–µ–Ω–∞ –ª–∏—á–Ω–æ –ì–ª–∞–¥ –í–∞–ª–∞–∫–∞—Å–æ–º.' },
        { id: 5, cat: 'kings', name: 'üëë –ö–æ—Ä–æ–ª—å –î–∏–∑–ª–∞–π–∫–æ–≤', price: 10.0, desc: '–û—Ç –°–µ—Ä–≥–µ—è –°–∏–º–æ–Ω–æ–≤–∞. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ö–∞–π–ø, –≤–Ω—É—Ç—Ä–∏ –º—è—Å–æ –∫–∞–±–∞–Ω–∞.' },
        { id: 6, cat: 'kings', name: 'ü§ú –®–∏—Ä–æ–∫–∞—è –∫–æ—Å—Ç—å', price: 13.0, desc: '–î–≤–æ–π–Ω–∞—è –ø–æ—Ä—Ü–∏—è –≤—Å–µ–≥–æ. –î–ª—è —Ç–µ—Ö, –∫—Ç–æ –Ω–∞ –º–∞—Å—Å–µ.' }
    ];

    const extras = [
        { name: 'üßÄ –°—ã—Ä–Ω—ã–π —Å–æ—É—Å', price: 1.5 },
        { name: 'üå∂ –û—Å—Ç—Ä—ã–π –±–∞—Ç—Ö–µ—Ä—Ç', price: 1.0 },
        { name: 'ü•ì –°–∞–ª–æ –í–∞–ª–∞–∫–∞—Å–∞', price: 2.0 }
    ];

    let cart = [];
    let tempItem = null;
    let tempExtras = new Set();

    function render(cat = 'all') {
        const catalog = document.getElementById('catalog');
        catalog.innerHTML = '';
        menu.forEach(item => {
            if (cat !== 'all' && item.cat !== cat) return;
            const div = document.createElement('div');
            div.className = 'item-card';
            div.innerHTML = `
                <h3>${item.name}</h3>
                <p>${item.desc}</p>
                <div class="price-row">
                    <span class="price">${item.price.toFixed(2)} BYN</span>
                    <button class="add-btn" onclick="openItem(${item.id})">–í–´–ë–†–ê–¢–¨</button>
                </div>
            `;
            catalog.appendChild(div);
        });
    }

    function openItem(id) {
        tempItem = menu.find(m => m.id === id);
        tempExtras.clear();
        document.getElementById('mName').innerText = tempItem.name;
        
        const mExtras = document.getElementById('mExtras');
        mExtras.innerHTML = '';
        extras.forEach(ex => {
            const div = document.createElement('div');
            div.className = 'extra-item';
            div.innerHTML = `<span>${ex.name}</span> <span>+${ex.price}</span>`;
            div.onclick = () => {
                div.classList.toggle('selected');
                tempExtras.has(ex) ? tempExtras.delete(ex) : tempExtras.add(ex);
                updateTempPrice();
            };
            mExtras.appendChild(div);
        });
        updateTempPrice();
        document.getElementById('modalOverlay').style.display = 'flex';
    }

    function updateTempPrice() {
        let p = tempItem.price;
        tempExtras.forEach(e => p += e.price);
        document.getElementById('mTotal').innerText = p.toFixed(2) + ' BYN';
    }

    function addToCart() {
        let p = tempItem.price;
        tempExtras.forEach(e => p += e.price);
        
        // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –¥–ª—è —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω–µ
        const cartId = Date.now();
        cart.push({
            cartId: cartId,
            name: tempItem.name,
            basePrice: p,
            qty: 1,
            extras: Array.from(tempExtras).map(e => e.name)
        });
        
        document.getElementById('modalOverlay').style.display = 'none';
        updateCartBar();
        if (tg.HapticFeedback) tg.HapticFeedback.notificationOccurred('success');
    }

    function updateCartBar() {
        const bar = document.getElementById('cartBar');
        if (cart.length > 0) {
            bar.style.display = 'flex';
            const total = cart.reduce((s, i) => s + (i.basePrice * i.qty), 0);
            document.getElementById('cCount').innerText = cart.length;
            document.getElementById('cPrice').innerText = total.toFixed(2);
        } else {
            bar.style.display = 'none';
        }
    }

    function openCart() {
        const list = document.getElementById('cartList');
        list.innerHTML = '';
        cart.forEach(item => {
            const div = document.createElement('div');
            div.className = 'cart-item';
            div.innerHTML = `
                <div>
                    <div style="font-weight:bold">${item.name}</div>
                    <div style="font-size:10px; opacity:0.5">${item.extras.join(', ')}</div>
                </div>
                <div class="qty-ctrl">
                    <button class="btn-qty" onclick="changeCartQty(${item.cartId}, -1)">‚àí</button>
                    <span>${item.qty}</span>
                    <button class="btn-qty" onclick="changeCartQty(${item.cartId}, 1)">+</button>
                    <button class="btn-qty" style="color:red; border:none" onclick="removeFromCart(${item.cartId})">üóë</button>
                </div>
            `;
            list.appendChild(div);
        });
        
        const total = cart.reduce((s, i) => s + (i.basePrice * i.qty), 0);
        document.getElementById('cartFullPrice').innerText = total.toFixed(2) + ' BYN';
        document.getElementById('cartOverlay').style.display = 'flex';
    }

    function changeCartQty(cartId, delta) {
        const item = cart.find(i => i.cartId === cartId);
        if (item) {
            item.qty = Math.max(1, item.qty + delta);
            openCart(); // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å
            updateCartBar();
        }
    }

    function removeFromCart(cartId) {
        cart = cart.filter(i => i.cartId !== cartId);
        if (cart.length === 0) closeCart();
        else openCart();
        updateCartBar();
    }

    function closeCart() { document.getElementById('cartOverlay').style.display = 'none'; }

    function filter(c, el) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        el.classList.add('active');
        render(c);
    }

    function sendOrder() {
        const total = cart.reduce((s, i) => s + (i.basePrice * i.qty), 0);
        tg.sendData(JSON.stringify({
            items: cart,
            total: total
        }));
    }

    window.onclick = (e) => {
        if(e.target.id === 'modalOverlay') document.getElementById('modalOverlay').style.display = 'none';
    }
    render();
</script>
</body>
</html>
