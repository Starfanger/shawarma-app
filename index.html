<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Doner Duck</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --orange: #ff5e00; }
        body { font-family: -apple-system, sans-serif; padding: 20px; background: #fff; color: #333; margin: 0; }
        .header { text-align: center; color: var(--orange); margin-bottom: 25px; }
        .section-title { font-weight: bold; margin: 20px 0 10px; font-size: 1.1em; }
        
        .card-row { display: flex; gap: 10px; margin-bottom: 15px; }
        .card { flex: 1; border: 2px solid #eee; border-radius: 12px; padding: 15px; text-align: center; cursor: pointer; transition: 0.2s; }
        .card.active { border-color: var(--orange); background: #fff8f0; }
        
        .ingredient { display: flex; align-items: center; justify-content: space-between; padding: 12px; border-bottom: 1px solid #f5f5f5; }
        .ingredient input { width: 22px; height: 22px; accent-color: var(--orange); }

        .footer { position: fixed; bottom: 0; left: 0; right: 0; padding: 15px; background: #fff; border-top: 1px solid #eee; }
        .order-btn { width: 100%; background: var(--orange); color: white; border: none; padding: 18px; border-radius: 15px; font-size: 1.1em; font-weight: bold; cursor: pointer; }
        .order-btn:disabled { background: #ccc; }
        
        #qty { width: 60px; padding: 8px; border-radius: 8px; border: 1px solid #ddd; font-size: 1em; }
    </style>
</head>
<body>

    <div class="header"><h1>ü¶Ü DONER DUCK</h1></div>

    <div class="section-title">–¢–∏–ø —à–∞—É—Ä–º—ã</div>
    <div class="card-row" id="typeGroup">
        <div class="card active" data-type="chicken" data-price="5.00">–ö—É—Ä–∏–Ω–∞—è<br>5.00 Br</div>
        <div class="card" data-type="beef" data-price="6.00">–ú—è—Å–Ω–∞—è<br>6.00 Br</div>
    </div>

    <div class="section-title">–†–∞–∑–º–µ—Ä</div>
    <div class="card-row" id="sizeGroup">
        <div class="card active" data-size="standard" data-add="0">–°—Ç–∞–Ω–¥–∞—Ä—Ç</div>
        <div class="card" data-size="large" data-add="2.5">–ë–æ–ª—å—à–∞—è (+2.50)</div>
    </div>

    <div class="section-title">–î–æ–±–∞–≤–∫–∏</div>
    <div id="extras">
        <label class="ingredient"><span>–î–æ–ø. –º—è—Å–æ (+1.50)</span> <input type="checkbox" data-name="–î–æ–ø. –º—è—Å–æ" data-price="1.50"></label>
        <label class="ingredient"><span>–°—ã—Ä (+0.80)</span> <input type="checkbox" data-name="–°—ã—Ä" data-price="0.80"></label>
        <label class="ingredient"><span>–û—Å—Ç—Ä—ã–π —Å–æ—É—Å (+0.30)</span> <input type="checkbox" data-name="–û—Å—Ç—Ä—ã–π —Å–æ—É—Å" data-price="0.30"></label>
    </div>

    <div class="section-title">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: <input type="number" id="qty" value="1" min="1"></div>

    <div style="height: 120px;"></div>

    <div class="footer">
        <button id="orderBtn" class="order-btn">–ó–∞–∫–∞–∑–∞—Ç—å –∑–∞ <span id="totalPrice">5.00</span> Br</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();

        let order = {
            type: 'chicken',
            size: 'standard',
            quantity: 1
        };

        function updatePrice() {
            let base = order.type === 'chicken' ? 5.00 : 6.00;
            let sizeAdd = order.size === 'large' ? 2.50 : 0;
            let extras = 0;
            
            document.querySelectorAll('#extras input:checked').forEach(i => {
                extras += parseFloat(i.dataset.price);
            });

            const final = (base + sizeAdd + extras) * order.quantity;
            document.getElementById('totalPrice').innerText = final.toFixed(2);
            return final;
        }

        // –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –≤–æ –≤—Å–µ—Ö –∫–∞—Ä—Ç–æ—á–∫–∞—Ö
        document.querySelectorAll('.card').forEach(el => {
            el.onclick = () => {
                el.parentElement.querySelectorAll('.card').forEach(c => c.classList.remove('active'));
                el.classList.add('active');
                
                if (el.dataset.type) order.type = el.dataset.type;
                if (el.dataset.size) order.size = el.dataset.size;
                updatePrice();
            };
        });

        document.getElementById('qty').oninput = (e) => {
            order.quantity = Math.max(1, parseInt(e.target.value) || 1);
            updatePrice();
        };

        document.querySelectorAll('input[type="checkbox"]').forEach(c => c.onchange = updatePrice);

        // –û–¢–ü–†–ê–í–ö–ê
        document.getElementById('orderBtn').onclick = function() {
            const ingredients = [];
            document.querySelectorAll('#extras input:checked').forEach(i => {
                ingredients.push({ name: i.dataset.name });
            });

            const data = {
                type: order.type,
                size: order.size,
                quantity: order.quantity,
                ingredients: ingredients,
                total: updatePrice(),
                currency: 'BYN'
            };

            console.log("Sending data:", data);
            tg.sendData(JSON.stringify(data));
        };
    </script>
</body>
</html>
